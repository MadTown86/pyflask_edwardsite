{% extends "./base.jinja" %}
{% block content %}
<script>
    document.getElementById('member_nav').classList.add('active')
    document.getElementById('member_nav').classList.add('text-light')
    function nextClick() {
      const nowDate = new Date()
      const dateFromH2 = document.getElementById('date').innerText
      const newDate = new Date(dateFromH2)
      const oneDayMilliseconds = 86400000
      const timeDifference = Math.abs(nowDate - newDate)
      if (timeDifference > 10 * oneDayMilliseconds) {

      } else {
        document.getElementById('next-date-button').disabled = false
        newDate.setDate(newDate.getDate()+1)
        const dateFormatted = new Intl.DateTimeFormat('en-US').format(newDate)
        document.getElementById('date').innerText = dateFormatted
        document.getElementById('hidden_date').value = dateFormatted
      }
      const hiddenDate = document.getElementById('hidden_date').value
      console.log('Hidden Date:', hiddenDate)
    }

    function prevClick() {
      const orgDate = '{{date}}'
      const orgJavaDate = new Date(orgDate)
      const dateFromH2 = document.getElementById('date').innerText
      const newDate2 = new Date(dateFromH2)
      newDate2.setDate(newDate2.getDate()-1)
      const timeDifference2 = newDate2 - orgJavaDate
      console.log('Time Difference PrevClick:', timeDifference2)
      if (timeDifference2 < 0) {
      } else {
        document.getElementById('prev-date-button').disabled = false
        const dateFormatted = new Intl.DateTimeFormat('en-US').format(newDate2)
        document.getElementById('date').innerText = dateFormatted
        document.getElementById('hidden_date').value = dateFormatted
      }
      const hiddenDate = document.getElementById('hidden_date').value
      console.log('Hidden Date:', hiddenDate)
    }  
</script>
    <main>
    {% if timeslots and date %}
      <h1 class="text-center">Schedule</h1>
        <div class="d-flex justify-content-center schedule">
        <button id="prev-date-button" onclick="prevClick()"><span>&#8592</span></button>
        <h2 class="text-center" id="date">{{date}}</h2>
        <button id="next-date-button" onclick="nextClick()"><span>&#8594</span></button>
        </div>

      
      <form action="/schedule" method="POST">
        <input type="hidden" name="hidden_date" id="hidden_date" value="{{date}}">
          <div class="d-flex flex-column flex-md-row p-4 gap-4 py-md-5 align-items-center justify-content-center">
            <div class="list-group list-group-radio d-grid gap-2 border-0">
        {% for timeslot in timeslots %}
              {% if loop.index == 1 %}
                <div class="position-relative">
                <input class="form-check-input position-absolute top-50 end-0  me-3 fs-5" type="radio" name="listGroupRadioGrid" id="listGroupRadioGrid_{{timeslot}}" value="{{timeslot}}" checked="">
                <label class="list-group-item rounded-3 py-3 pe-5" for="listGroupRadioGrid_{{timeslot}}">
                  <strong class="fw-semibold">{{ timeslot }}</strong>
                </label>
              </div>
              {% else %}
              <div class="position-relative">
                <input class="form-check-input position-absolute top-50 end-0 me-3 fs-5" type="radio" name="listGroupRadioGrid" id="listGroupRadioGrid_{{timeslot}}" value="{{timeslot}}">
                <label class="list-group-item rounded-3 py-3 pe-5" for="listGroupRadioGrid_{{timeslot}}">
                  <strong class="fw-semibold">{{ timeslot }}</strong>
                </label>
              </div>
              {% endif %}
        {% endfor %}
          <button class="btn btn-primary rounded-pill px-3" type="submit" value="confirm" name="confirm">Confirm</button>
          </div>
        </div>
      </form>
    {% endif %}
</main>
{% endblock content %}